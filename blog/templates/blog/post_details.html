{% extends 'base.html' %}
{% load static %}

{% block meta-tags %}
	<meta name="description" content="{{ post.content }}">
{% endblock %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}

		<!-- Page Title ============================================= -->
		<section id="page-title">

			<div class="container clearfix">
				<h1>{{ post.title }}</h1>
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                    <li class="breadcrumb-item"><a href="{% url 'categories' category_slug=post.post_category.slug %}">{{ post.post_category }}</a></li>
					<li class="breadcrumb-item active" aria-current="page">{{ post.title }}</li>
				</ol>
			</div>

		</section><!-- #page-title end -->

		<!-- Content ============================================= -->
		<section id="content">
			<div class="content-wrap">
				<div class="container clearfix">
					<div class="row gutter-40 col-mb-80">
						<!-- Post Content ============================================= -->
						<div class="postcontent col-lg-9 order-lg-last">
							<div class="single-post mb-0">
								<!-- Single Post ============================================= -->
								<div class="entry clearfix">
									<!-- Entry Title ============================================= -->
									<div class="entry-title">
										<h2>{{ post.title }}</h2>
									</div><!-- .entry-title end -->
									<!-- Entry Meta ============================================= -->
									<div class="entry-meta">
										<ul>
											<li><i class="icon-calendar3"></i> {{ post.updated_at|date:"M-d-Y," }}</li>
											<li><a href="{% url 'auther' id=post.author.id %}"><i class="icon-user"></i> {{ post.author|title }}</a></li>
											<li><i class="icon-folder-open"></i> <a href="{% url 'categories' category_slug=post.post_category.slug %}">{{ post.post_category }}</a></li>
											{% if post.author.pk == request.user.pk %}
												<li><a href="{% url 'post-update' pk=post.id %}"><i class="icon-edit"></i> Edit</a></li>
												<li><a href="{% url 'post-delete' pk=post.id %}"><i class="icon-remove"></i> Delete</a></li>
											{% endif %}
										</ul>
									</div><!-- .entry-meta end -->
									<!-- Entry Image ============================================= -->
									<div class="entry-image">
										<img src="{{ post.image.url }}" alt="Blog Image">
									</div><!-- .entry-image end -->
									<!-- Entry Content ============================================= -->
									<div class="entry-content mt-0">
										<p>{{ post.content|linebreaks }}</p>
									</div>
								</div><!-- .entry end -->
								<!-- Comments ============================================= -->
								<div id="comments" class="clearfix">
									<h3 id="comments-title">{{ comments.count }} Comment{{ comments|pluralize }}</h3>
									<!-- Comments List ============================================= -->
									<ol class="commentlist clearfix">
										{% for comment in comments %}
										<li class="comment even thread-even depth-1" id="li-comment-1">
											<div id="comment-1" class="comment-wrap clearfix">
												<div class="comment-meta">
													<div class="comment-author vcard">
														<span class="comment-avatar clearfix">
														<img alt='Image' src='https://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' /></span>
													</div>
												</div>
												<div class="comment-content clearfix">
													<div class="comment-author">{{ comment.author|title }}<span><a href="#" title="Permalink to this comment">{{ comment.timestamp }}</a></span></div>
													<p>{{ comment.content|linebreaks }}</p>
													<a class='comment-reply-link' id="reply-btn-{{ comment.id }}" onclick="showForm{{ comment.id }}()"><i class="icon-reply"></i></a>

													{% if user.is_authenticated %}
														<div id="reply-form-{{ comment.id }}" style="display: none;">
														<form method="post">
															<div class="form-group">
																{% csrf_token %}
																{{ comment_form.as_p }}
																<input type="hidden" name="comment_id" value="{{ comment.id }}">
															</div>
															<div class="form-group">
																<button type="submit" value="Submit" class="button button-large button-black button-dark font-weight-medium ls0 button-rounded m-0">Reply</button>
															</div>
														</form>
														</div>
													{% endif %}
													<script type="text/javascript">
														function showForm{{ comment.id }}() {
															var form = document.getElementById("reply-form-{{ comment.id }}");
															var displaySetting = form.style.display;
															var formButton = document.getElementById("reply-btn-{{ comment.id }}");

															if (displaySetting == 'block') {
																form.style.display = 'none';
															}
															else {
																form.style.display = 'block';
															}
														}
													</script>
												</div>
												<div class="clear"></div>
											</div>
											{% for reply in comment.replies.all %}
											<ul class='children'>
												<li class="comment byuser comment-author-_smcl_admin odd alt depth-2" id="li-comment-3">
													<div id="comment-3" class="comment-wrap clearfix">
														<div class="comment-meta">
															<div class="comment-author vcard">
																<span class="comment-avatar clearfix">
																<img alt='Image' src='https://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-40 photo' height='40' width='40' /></span>
															</div>
														</div>
														<div class="comment-content clearfix">
															<div class="comment-author"><a href='#' rel='external nofollow' class='url'>{{reply.author|title}}</a><span><a title="Permalink to this comment">{{ reply.timestamp }}</a></span></div>
															<p>{{reply.content}}</p>
														</div>
														<div class="clear"></div>
													</div>
												</li>
											</ul>
											{% endfor %}
										</li>
										{% endfor %}
									</ol><!-- .commentlist end -->

									<div class="clear"></div>

                                    {% if user.is_authenticated %}
                                        <!-- Comment Form ============================================= -->
                                        <div id="respond">
                                            <h3>Leave a Comment</h3>
                                            <form class="" method="post">
                                                <div class="form-group">
                                                    {% csrf_token %}
                                                    {{ comment_form.as_p }}
                                                </div>
                                                
                                                <div class="form-group">
                                                    <button type="submit" value="Submit" class="button button-large button-black button-dark font-weight-medium ls0 button-rounded m-0">Comment</button>
                                                </div>
                                            </form>
                                        </div><!-- #respond end -->
                                    {% else %}
                                        <h3><a href="{% url 'login' %}"><u>Please Login To Comment!</u></a></h3>
                                    {% endif %}
								</div><!-- #comments end -->
							</div>
						</div><!-- .postcontent end -->
						<!-- Sidebar ============================================= -->
						<div class="sidebar col-lg-3">
							<div class="sidebar-widgets-wrap">
								<div class="widget clearfix">
									<div class="tabs mb-0 clearfix" id="sidebar-tabs">
										<div class="tab-container">
											<div class="tab-content clearfix" id="tabs-1">
												<div class="posts-sm row col-mb-30" id="popular-post-list-sidebar">
													<div class="entry col-12">
														<div class="grid-inner row g-0">
															<div class="col ps-3">
																<div class="entry-title">
																	<h3><a href="#">Categories</a></h3>
																</div>
															</div>
														</div>
													</div>
                                                    {% for category in categories %}
                                                        <div class="entry col-12">
                                                            <div class="grid-inner row g-0">
                                                                <div class="col ps-3">
                                                                    <div class="entry-title">
                                                                        <h4><a href="{% url 'categories' category_slug=category.slug %}">{{ category.name }}</a></h4>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    {% endfor %}
												</div>
											</div>																					
										</div>
									</div>
								</div>												
							</div>
						</div><!-- .sidebar end -->
					</div>
				</div>
			</div>
		</section><!-- #content end -->

{% endblock %}
